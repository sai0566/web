<!DOCTYPE html>
<html>

<head>
    <title>Game Dashboard</title>
    <style>
        body {
            margin: 0;
            font-family: 'Arial', sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            background: linear-gradient(135deg, #ff7e5f, #feb47b);
        }

        .container {
            text-align: center;
            background-color: #ffffff;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            width: 100%;
            max-width: 500px;
        }

        .btn {
            padding: 10px 20px;
            margin: 10px;
            font-size: 16px;
            background-color: #4285f4;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        .btn:hover {
            background-color: #3367d6;
        }

        .game {
            display: grid;
            grid-template-columns: repeat(3, 100px);
            grid-gap: 10px;
            justify-content: center;
            margin: 20px 0;
        }

        .cell {
            width: 100px;
            height: 100px;
            background-color: #e0e0e0;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 2rem;
            cursor: pointer;
            user-select: none;
            border-radius: 10px;
        }

        .cell.x {
            background-color: #66cc66;
            color: #fff;
        }

        .cell.o {
            background-color: #ff6666;
            color: #fff;
        }

        .scoreboard {
            margin: 10px 0;
            font-size: 18px;
            font-weight: bold;
            color: #333;
        }

        .grid-container {
            display: grid;
            grid-template-columns: repeat(4, 80px);
            grid-gap: 10px;
            justify-content: center;
            margin: 20px auto;
        }

        .tile {
            width: 80px;
            height: 80px;
            background-color: #ccc0b3;
            font-size: 24px;
            font-weight: bold;
            color: #776e65;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 8px;
        }

        #difficulty-select {
            margin-bottom: 10px;
        }
    </style>
</head>

<body>
    <div class="container">
        <div id="gameMenu">
            <h2>Select a Game</h2>
            <button class="btn" onclick="selectGame('tictactoe')">Tic Tac Toe</button>
            <button class="btn" onclick="selectGame('2048')">2048</button>
        </div>

        <div id="ticTacToeGame" style="display:none;">
            <div class="scoreboard" id="scoreboard">Player X: 0 | AI (O): 0</div>
            <div class="status" id="gameStatus">Player X's turn</div>
            <div class="game" id="gameBoard"></div>
            <select id="difficulty-select" onchange="changeDifficulty()">
                <option value="easy">Easy</option>
                <option value="medium">Medium</option>
                <option value="hard" selected>Hard</option>
            </select>
            <button class="btn" onclick="resetGame()">Reset Game</button>
            <button class="btn" onclick="resetScores()">Reset Scores</button>
            <button class="btn" onclick="backToMenu()">Back to Menu</button>
        </div>

        <div id="game2048" style="display:none;">
            <h2>2048 Game</h2>
            <div class="scoreboard">
                <div>Score: <span id="score">0</span></div>
                <div>High Score: <span id="highScore">0</span></div>
            </div>
            <div id="grid-container" class="grid-container"></div>
            <button class="btn" onclick="backToMenu()">Back to Menu</button>
        </div>
    </div>

    <script>
        // Tic Tac Toe Logic
        const gameBoard = document.getElementById('gameBoard');
        const gameStatus = document.getElementById('gameStatus');
        const scoreboard = document.getElementById('scoreboard');
        const difficultySelect = document.getElementById('difficulty-select');
        let board = Array(9).fill(null);
        let currentPlayer = 'X';
        let scores = {
            X: 0,
            O: 0
        };
        let gameOver = false;
        let difficulty = 'hard'; // Default difficulty

        function changeDifficulty() {
            difficulty = difficultySelect.value;
            resetGame(); // Reset the game when difficulty changes
        }

        function checkWinner() {
            const winPatterns = [
                [0, 1, 2],
                [3, 4, 5],
                [6, 7, 8],
                [0, 3, 6],
                [1, 4, 7],
                [2, 5, 8],
                [0, 4, 8],
                [2, 4, 6]
            ];
            for (const [a, b, c] of winPatterns) {
                if (board[a] && board[a] === board[b] && board[b] === board[c]) return board[a];
            }
            return board.includes(null) ? null : 'Draw';
        }

        function handleClick(i) {
            if (board[i] || gameOver || currentPlayer !== 'X') return;
            board[i] = 'X';
            render();
            let result = checkWinner();
            if (result) return endGame(result);
            currentPlayer = 'O';
            gameStatus.textContent = "AI is thinking...";
            setTimeout(() => {
                aiMove();
                render();
                result = checkWinner();
                if (result) return endGame(result);
                currentPlayer = 'X';
                gameStatus.textContent = "Player X's turn";
            }, 1000); // 2000 milliseconds = 2 seconds
        }

        function aiMove() {
            let move;
            if (difficulty === 'easy') {
                move = easyMove(board);
            } else if (difficulty === 'medium') {
                move = mediumMove(board);
            } else {
                move = hardMove(board, 'O');
            }

            if (move.index !== undefined) {
                board[move.index] = 'O';
            }
        }

        function easyMove(board) {
            const availableMoves = getAvailableMoves(board);
            const randomIndex = Math.floor(Math.random() * availableMoves.length);
            return availableMoves[randomIndex];
        }

        function mediumMove(board) {
            // 70% chance of playing optimally, 30% chance of playing randomly
            if (Math.random() < 0.7) {
                return hardMove(board, 'O');
            } else {
                return easyMove(board);
            }
        }

        function hardMove(board, player) {
            const availableMoves = getAvailableMoves(board);

            let bestMove = { index: null, score: player === 'O' ? -Infinity : Infinity };

            for (let i = 0; i < availableMoves.length; i++) {
                const move = availableMoves[i];
                board[move.index] = player;
                let score = minimax(board, player === 'O' ? 'X' : 'O', 0);
                board[move.index] = null; // Reset the board

                if (player === 'O') {
                    if (score > bestMove.score) {
                        bestMove.score = score;
                        bestMove.index = move.index;
                    }
                } else {
                    if (score < bestMove.score) {
                        bestMove.score = score;
                        bestMove.index = move.index;
                    }
                }
            }

            return bestMove;
        }

        function minimax(board, player, depth) {
            const availableMoves = getAvailableMoves(board);
            const winner = checkWinner();

            if (winner === 'X') return -1;
            if (winner === 'O') return 1;
            if (availableMoves.length === 0) return 0;

            let bestScore = player === 'O' ? -Infinity : Infinity;

            for (let i = 0; i < availableMoves.length; i++) {
                const move = availableMoves[i];
                board[move.index] = player;
                let score = minimax(board, player === 'O' ? 'X' : 'O', depth + 1);
                board[move.index] = null;

                if (player === 'O') {
                    bestScore = Math.max(score, bestScore);
                } else {
                    bestScore = Math.min(score, bestScore);
                }
            }

            return bestScore;
        }

        function getAvailableMoves(board) {
            return board.reduce((acc, val, index) => {
                if (val === null) acc.push({ index });
                return acc;
            }, []);
        }

        function render() {
            gameBoard.innerHTML = '';
            board.forEach((v, i) => {
                const cell = document.createElement('div');
                cell.className = 'cell ' + (v ? v.toLowerCase() : '');
                cell.textContent = v || '';
                cell.onclick = () => handleClick(i);
                gameBoard.appendChild(cell);
            });
        }

        function endGame(result) {
            gameOver = true;
            if (result === 'Draw') {
                gameStatus.textContent = "It's a Draw!";
            } else {
                gameStatus.textContent = `Player ${result} wins!`;
                scores[result]++;
            }
            updateScoreboard();
        }

        function resetGame() {
            board = Array(9).fill(null);
            currentPlayer = 'X';
            gameOver = false;
            gameStatus.textContent = "Player X's turn";
            render();
        }

        function resetScores() {
            scores = {
                X: 0,
                O: 0
            };
            updateScoreboard();
            resetGame();
        }

        function updateScoreboard() {
            scoreboard.textContent = `Player X: ${scores.X} | AI (O): ${scores.O}`;
        }

        // 2048 Game Logic
        const gridContainer = document.getElementById('grid-container');
        let grid = [],
            score = 0,
            highScore = localStorage.getItem('highScore2048') || 0;

        function init2048() {
            grid = Array.from({
                length: 4
            }, () => Array(4).fill(0));
            score = 0;
            addTile();
            addTile();
            drawGrid();
            document.addEventListener('keydown', handleKey);
        }

        function drawGrid() {
            gridContainer.innerHTML = '';
            for (let row of grid) {
                for (let cell of row) {
                    const tile = document.createElement('div');
                    tile.className = 'tile';
                    tile.textContent = cell || '';
                    tile.style.backgroundColor = getTileColor(cell);
                    gridContainer.appendChild(tile);
                }
            }
            document.getElementById('score').textContent = score;
            document.getElementById('highScore').textContent = highScore;
        }

        function getTileColor(val) {
            const colors = {
                0: '#cdc1b4',
                2: '#eee4da',
                4: '#ede0c8',
                8: '#f2b179',
                16: '#f59563',
                32: '#f67c5f',
                64: '#f65e3b',
                128: '#edcf72',
                256: '#edcc61',
                512: '#edc850',
                1024: '#edc53f',
                2048: '#edc22e'
            };
            return colors[val] || '#3c3a32';
        }

        function addTile() {
            const empty = [];
            for (let i = 0; i < 4; i++)
                for (let j = 0; j < 4; j++)
                    if (grid[i][j] === 0) empty.push([i, j]);
            if (empty.length) {
                const [i, j] = empty[Math.floor(Math.random() * empty.length)];
                grid[i][j] = Math.random() < 0.9 ? 2 : 4;
            }
        }

        function handleKey(e) {
            const oldGrid = JSON.stringify(grid);
            if (['ArrowUp', 'ArrowDown', 'ArrowLeft', 'ArrowRight'].includes(e.key)) {
                move(e.key.replace('Arrow', '').toLowerCase());
                if (JSON.stringify(grid) !== oldGrid) {
                    addTile();
                    drawGrid();
                }
            }
        }

        function move(dir) {
            const rotate = m => m[0].map((_, i) => m.map(row => row[i]));
            const reverse = m => m.map(r => r.reverse());
            let g = [...grid.map(r => [...r])];
            if (dir === 'up') g = rotate(g);
            if (dir === 'down') g = reverse(rotate(g));
            if (dir === 'right') g = g.map(r => r.reverse());

            for (let row of g) {
                for (let i = 0; i < 3; i++) {
                    if (row[i] && row[i] === row[i + 1]) {
                        row[i] *= 2;
                        score += row[i];
                        if (score > highScore) {
                            highScore = score;
                            localStorage.setItem('highScore2048', highScore);
                        }
                        row[i + 1] = 0;
                    }
                }
                let f = row.filter(v => v !== 0);
                while (f.length < 4) f.push(0);
                for (let i = 0; i < 4; i++) row[i] = f[i];
            }

            if (dir === 'up') grid = rotate(g);
            if (dir === 'down') grid = rotate(reverse(g));
            if (dir === 'left') grid = g;
            if (dir === 'right') grid = g.map(r => r.reverse());
        }

        function selectGame(game) {
            localStorage.setItem('preferredGame', game);
            window.location.reload(); // Reload to apply the choice on load
        }

        function startGame(game) {
            document.getElementById('gameMenu').style.display = 'none';
            document.getElementById('ticTacToeGame').style.display = 'none';
            document.getElementById('game2048').style.display = 'none';

            if (game === 'tictactoe') {
                document.getElementById('ticTacToeGame').style.display = 'block';
                resetGame();
            } else if (game === '2048') {
                document.getElementById('game2048').style.display = 'block';
                init2048();
            }
        }

        function backToMenu() {
            document.getElementById('ticTacToeGame').style.display = 'none';
            document.getElementById('game2048').style.display = 'none';
            document.getElementById('gameMenu').style.display = 'block';
            document.removeEventListener('keydown', handleKey);
        }

        // Check for preferred game on load
        document.addEventListener('DOMContentLoaded', () => {
            const preferredGame = localStorage.getItem('preferredGame');
            if (preferredGame) {
                startGame(preferredGame);
            } else {
                document.getElementById('gameMenu').style.display = 'block'; // Show menu if no preference
            }
            render(); // Initial render for Tic Tac Toe (hidden initially)
        });
    </script>
</body>

</html>
